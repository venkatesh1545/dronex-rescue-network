
{% extends "base.html" %}

{% block title %}User Profile - DRONEX{% endblock %}

{% block content %}
<div class="bg-gray-50 py-12">
    <div class="container">
        <div class="max-w-3xl mx-auto">
            <div class="text-center mb-8">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-primary/10 text-primary rounded-full mb-4">
                    <i class="fas fa-user text-xl"></i>
                </div>
                <h1 class="text-3xl font-bold mb-2">Your Profile</h1>
                <p class="text-gray-600">
                    Manage your account settings and preferences
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Sidebar Navigation -->
                <div class="md:col-span-1">
                    <div class="card">
                        <div class="p-4">
                            <nav class="space-y-1">
                                <a href="#personal-info" class="profile-nav-item active" data-section="personal-info">
                                    <i class="fas fa-user-circle"></i>
                                    <span>Personal Information</span>
                                </a>
                                <a href="#notifications" class="profile-nav-item" data-section="notifications">
                                    <i class="fas fa-bell"></i>
                                    <span>Notifications</span>
                                </a>
                                <a href="#emergency-contacts" class="profile-nav-item" data-section="emergency-contacts">
                                    <i class="fas fa-phone-alt"></i>
                                    <span>Emergency Contacts</span>
                                </a>
                                <a href="#location" class="profile-nav-item" data-section="location">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>Location Settings</span>
                                </a>
                                <a href="#security" class="profile-nav-item" data-section="security">
                                    <i class="fas fa-shield-alt"></i>
                                    <span>Security</span>
                                </a>
                            </nav>
                        </div>
                    </div>
                </div>
                
                <!-- Content Area -->
                <div class="md:col-span-2">
                    <!-- Personal Information Section -->
                    <div id="personal-info" class="profile-section active">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Personal Information</h2>
                            </div>
                            <div class="card-content">
                                <form id="personal-info-form">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                        <div class="form-group">
                                            <label for="first-name" class="form-label">First Name</label>
                                            <input type="text" id="first-name" name="first_name" class="form-input" value="John">
                                        </div>
                                        <div class="form-group">
                                            <label for="last-name" class="form-label">Last Name</label>
                                            <input type="text" id="last-name" name="last_name" class="form-input" value="Doe">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group mb-4">
                                        <label for="email" class="form-label">Email</label>
                                        <input type="email" id="email" name="email" class="form-input" value="{{ session.get('user', '') }}">
                                    </div>
                                    
                                    <div class="form-group mb-4">
                                        <label for="phone" class="form-label">Phone Number</label>
                                        <input type="tel" id="phone" name="phone" class="form-input" value="(555) 123-4567">
                                    </div>
                                    
                                    <div class="flex justify-end">
                                        <button type="submit" class="btn btn-primary">
                                            Save Changes
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Notifications Section -->
                    <div id="notifications" class="profile-section hidden">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Notification Preferences</h2>
                            </div>
                            <div class="card-content">
                                <form id="notifications-form">
                                    <div class="space-y-4">
                                        <div class="form-checkbox">
                                            <input type="checkbox" id="notify-email" name="notify_email" checked>
                                            <label for="notify-email">Email Notifications</label>
                                        </div>
                                        <div class="form-checkbox">
                                            <input type="checkbox" id="notify-sms" name="notify_sms" checked>
                                            <label for="notify-sms">SMS Notifications</label>
                                        </div>
                                        <div class="form-checkbox">
                                            <input type="checkbox" id="notify-app" name="notify_app">
                                            <label for="notify-app">Push Notifications</label>
                                        </div>
                                        
                                        <div class="border-t border-gray-200 pt-4 mt-4">
                                            <h3 class="text-lg font-medium mb-3">Notification Types</h3>
                                            
                                            <div class="space-y-3">
                                                <div class="form-checkbox">
                                                    <input type="checkbox" id="alert-emergency" name="alert_emergency" checked>
                                                    <label for="alert-emergency">Emergency Alerts</label>
                                                </div>
                                                <div class="form-checkbox">
                                                    <input type="checkbox" id="alert-weather" name="alert_weather" checked>
                                                    <label for="alert-weather">Weather Warnings</label>
                                                </div>
                                                <div class="form-checkbox">
                                                    <input type="checkbox" id="alert-evacuation" name="alert_evacuation" checked>
                                                    <label for="alert-evacuation">Evacuation Notices</label>
                                                </div>
                                                <div class="form-checkbox">
                                                    <input type="checkbox" id="alert-updates" name="alert_updates">
                                                    <label for="alert-updates">Recovery Updates</label>
                                                </div>
                                                <div class="form-checkbox">
                                                    <input type="checkbox" id="alert-resources" name="alert_resources">
                                                    <label for="alert-resources">Resource Availability</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="flex justify-end mt-6">
                                        <button type="submit" class="btn btn-primary">
                                            Save Preferences
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Emergency Contacts Section -->
                    <div id="emergency-contacts" class="profile-section hidden">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Emergency Contacts</h2>
                            </div>
                            <div class="card-content">
                                <div class="space-y-4 mb-6">
                                    <div class="border border-gray-200 rounded-md p-4">
                                        <div class="flex justify-between">
                                            <div>
                                                <h3 class="font-medium">Jane Doe</h3>
                                                <p class="text-sm text-gray-600">Relationship: Spouse</p>
                                                <p class="text-sm text-gray-600">Phone: (555) 987-6543</p>
                                            </div>
                                            <div class="flex items-start gap-2">
                                                <button class="action-btn edit">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="action-btn delete">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="border border-gray-200 rounded-md p-4">
                                        <div class="flex justify-between">
                                            <div>
                                                <h3 class="font-medium">Robert Smith</h3>
                                                <p class="text-sm text-gray-600">Relationship: Father</p>
                                                <p class="text-sm text-gray-600">Phone: (555) 765-4321</p>
                                            </div>
                                            <div class="flex items-start gap-2">
                                                <button class="action-btn edit">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="action-btn delete">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <form id="add-contact-form">
                                    <h3 class="text-lg font-medium mb-4">Add New Contact</h3>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                        <div class="form-group">
                                            <label for="contact-name" class="form-label">Full Name</label>
                                            <input type="text" id="contact-name" name="contact_name" class="form-input" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="contact-relationship" class="form-label">Relationship</label>
                                            <input type="text" id="contact-relationship" name="contact_relationship" class="form-input" required>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group mb-4">
                                        <label for="contact-phone" class="form-label">Phone Number</label>
                                        <input type="tel" id="contact-phone" name="contact_phone" class="form-input" required>
                                    </div>
                                    
                                    <div class="form-group mb-4">
                                        <label for="contact-email" class="form-label">Email (Optional)</label>
                                        <input type="email" id="contact-email" name="contact_email" class="form-input">
                                    </div>
                                    
                                    <div class="flex justify-end">
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-plus mr-2"></i>
                                            Add Contact
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Location Settings Section -->
                    <div id="location" class="profile-section hidden">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Location Settings</h2>
                            </div>
                            <div class="card-content">
                                <form id="location-form">
                                    <div class="form-group mb-4">
                                        <label for="home-address" class="form-label">Home Address</label>
                                        <input type="text" id="home-address" name="home_address" class="form-input" value="123 Main St, Anytown, USA 12345">
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                        <div class="form-group">
                                            <label for="city" class="form-label">City</label>
                                            <input type="text" id="city" name="city" class="form-input" value="Anytown">
                                        </div>
                                        <div class="form-group">
                                            <label for="state" class="form-label">State</label>
                                            <input type="text" id="state" name="state" class="form-input" value="CA">
                                        </div>
                                        <div class="form-group">
                                            <label for="zip" class="form-label">ZIP Code</label>
                                            <input type="text" id="zip" name="zip" class="form-input" value="12345">
                                        </div>
                                    </div>
                                    
                                    <div class="form-checkbox mb-4">
                                        <input type="checkbox" id="location-tracking" name="location_tracking" checked>
                                        <label for="location-tracking">
                                            Enable location tracking for emergency alerts
                                        </label>
                                        <p class="text-xs text-gray-500 mt-1 ml-6">
                                            This allows DRONEX to send you location-specific emergency alerts even when the app is closed.
                                        </p>
                                    </div>
                                    
                                    <div class="form-group mb-4">
                                        <label for="alert-radius" class="form-label">Alert Radius</label>
                                        <select id="alert-radius" name="alert_radius" class="form-select">
                                            <option value="5">5 miles</option>
                                            <option value="10" selected>10 miles</option>
                                            <option value="25">25 miles</option>
                                            <option value="50">50 miles</option>
                                            <option value="100">100 miles</option>
                                        </select>
                                        <p class="text-xs text-gray-500 mt-1">
                                            Receive alerts for emergencies within this distance from your location.
                                        </p>
                                    </div>
                                    
                                    <div class="flex justify-end">
                                        <button type="submit" class="btn btn-primary">
                                            Save Location Settings
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Security Section -->
                    <div id="security" class="profile-section hidden">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Security Settings</h2>
                            </div>
                            <div class="card-content">
                                <form id="password-form" class="mb-6">
                                    <h3 class="text-lg font-medium mb-4">Change Password</h3>
                                    
                                    <div class="form-group mb-4">
                                        <label for="current-password" class="form-label">Current Password</label>
                                        <input type="password" id="current-password" name="current_password" class="form-input" required>
                                    </div>
                                    
                                    <div class="form-group mb-4">
                                        <label for="new-password" class="form-label">New Password</label>
                                        <input type="password" id="new-password" name="new_password" class="form-input" required>
                                    </div>
                                    
                                    <div class="form-group mb-4">
                                        <label for="confirm-password" class="form-label">Confirm New Password</label>
                                        <input type="password" id="confirm-password" name="confirm_password" class="form-input" required>
                                    </div>
                                    
                                    <div class="flex justify-end">
                                        <button type="submit" class="btn btn-primary">
                                            Update Password
                                        </button>
                                    </div>
                                </form>
                                
                                <div class="border-t border-gray-200 pt-6">
                                    <h3 class="text-lg font-medium mb-4">Account Security</h3>
                                    
                                    <div class="form-checkbox mb-4">
                                        <input type="checkbox" id="two-factor" name="two_factor">
                                        <label for="two-factor">
                                            Enable Two-Factor Authentication
                                        </label>
                                        <p class="text-xs text-gray-500 mt-1 ml-6">
                                            Add an extra layer of security to your account by requiring a verification code in addition to your password.
                                        </p>
                                    </div>
                                    
                                    <div class="form-checkbox mb-4">
                                        <input type="checkbox" id="login-alerts" name="login_alerts" checked>
                                        <label for="login-alerts">
                                            Login Alerts
                                        </label>
                                        <p class="text-xs text-gray-500 mt-1 ml-6">
                                            Receive notifications when your account is accessed from a new device or location.
                                        </p>
                                    </div>
                                    
                                    <div class="flex justify-end">
                                        <button type="button" class="btn btn-primary" id="save-security">
                                            Save Security Settings
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Profile navigation handling
    const navItems = document.querySelectorAll('.profile-nav-item');
    const sections = document.querySelectorAll('.profile-section');
    
    navItems.forEach(item => {
        item.addEventListener('click', function(e) {
            e.preventDefault();
            
            const targetSection = this.getAttribute('data-section');
            
            // Remove active class from all nav items and sections
            navItems.forEach(navItem => navItem.classList.remove('active'));
            sections.forEach(section => section.classList.add('hidden'));
            
            // Add active class to clicked nav item and corresponding section
            this.classList.add('active');
            document.getElementById(targetSection).classList.remove('hidden');
        });
    });
    
    // Form submission handling
    const forms = document.querySelectorAll('form');
    forms.forEach(form => {
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // In a real app, this would send data to the server
            showNotification('Changes saved successfully!', 'success');
        });
    });
    
    // Security settings button
    const saveSecurityBtn = document.getElementById('save-security');
    if (saveSecurityBtn) {
        saveSecurityBtn.addEventListener('click', function() {
            showNotification('Security settings updated!', 'success');
        });
    }
    
    // Add CSS to active nav item
    document.querySelector('.profile-nav-item.active').classList.add('bg-primary/10', 'text-primary');
    
    // Style all nav items
    document.querySelectorAll('.profile-nav-item').forEach(item => {
        item.classList.add('flex', 'items-center', 'gap-3', 'p-2', 'rounded-md', 'hover:bg-gray-100');
        
        item.addEventListener('click', function() {
            document.querySelectorAll('.profile-nav-item').forEach(navItem => {
                navItem.classList.remove('bg-primary/10', 'text-primary');
            });
            this.classList.add('bg-primary/10', 'text-primary');
        });
    });
    
    // Action buttons event listeners
    document.querySelectorAll('.action-btn.edit').forEach(button => {
        button.addEventListener('click', function() {
            alert('Edit functionality would open a modal in production');
        });
    });
    
    document.querySelectorAll('.action-btn.delete').forEach(button => {
        button.addEventListener('click', function() {
            if (confirm('Are you sure you want to delete this contact?')) {
                showNotification('Contact deleted successfully!', 'success');
            }
        });
    });
});
</script>
{% endblock %}
